<% content_for :breadcrumb do %>
<div class="page-header pull-left">
  <div class="page-title">Add/Adjust Credits</div>
</div>
<ol class="breadcrumb page-breadcrumb pull-right">
  <li><i class="fa fa-home"></i>&nbsp;<a href="/">Home</a>&nbsp;&nbsp;<i class="fa fa-angle-right"></i>&nbsp;&nbsp;</li>
  <li><a href="<%= admin_credits_path %>">Admin Credits</a>&nbsp;&nbsp;<i class="fa fa-angle-right"></i>&nbsp;&nbsp;</li>
  <li class="active">Adjust Credits</li>
</ol>
<%end%>

<% content_for :main_body do %>
<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <div class="card">
        <div class="card-header bg-warning text-white">
          <h5 class="mb-0">Admin Credit Adjustment</h5>
        </div>
        <div class="card-body">
          <div class="alert alert-info">
            <strong>User:</strong> <%= @user.name %> (<%= @user.email %>)<br>
            <strong>Current Balance:</strong> $<%= '%.2f' % @user.credits_balance %>
          </div>

          <%= form_with url: admin_user_credits_path(@user), method: :post, local: true do |f| %>
            <div class="form-group">
              <label for="transaction_type">Transaction Type</label>
              <%= select_tag :transaction_type,
                  options_for_select([
                    ['Deposit', CreditTransaction::DEPOSIT],
                    ['Refund', CreditTransaction::REFUND],
                    ['Admin Adjustment', CreditTransaction::ADMIN_ADJUSTMENT]
                  ], CreditTransaction::ADMIN_ADJUSTMENT),
                  class: 'form-control' %>
            </div>

            <div class="form-group">
              <label for="amount">Amount</label>
              <div class="input-group">
                <div class="input-group-prepend">
                  <span class="input-group-text">$</span>
                </div>
                <%= number_field_tag :amount, '',
                    class: 'form-control',
                    placeholder: 'Enter amount (positive to add, negative to subtract)',
                    step: '0.01',
                    required: true %>
              </div>
              <small class="form-text text-muted">
                Use positive numbers to add credits, negative to subtract
              </small>
            </div>

            <div class="form-group">
              <label for="description">Description</label>
              <%= text_area_tag :description, '',
                  class: 'form-control',
                  placeholder: 'Reason for adjustment',
                  rows: 3,
                  required: true %>
            </div>

            <div class="mt-4">
              <%= f.submit 'Apply Adjustment', class: 'btn btn-warning btn-block' %>
              <%= link_to 'Cancel', admin_credits_path, class: 'btn btn-secondary btn-block' %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
<%end%>
